import{_ as R,r as v,k as U,aa as Y,y as G,A as J,ap as K,b as u,e as s,q as O,j as a,N as f,F as $,i as D,o as r}from"./index-XQHuw6kS.js";const Q={class:"sr-page"},W={class:"sr-card"},X={class:"sr-head"},Z={class:"sr-summary"},ss={class:"pill"},ts={class:"pill subtle"},es={class:"sr-filters"},as={class:"sr-list"},os={key:0,class:"sr-skeleton"},ls={key:0,class:"sr-empty"},ns={class:"left"},cs={class:"line1"},is={class:"source"},us={class:"desc"},rs={class:"time"},ds={class:"right"},vs={class:"balance"},_s={class:"sr-pagination"},hs=["disabled"],ps={class:"page-mid"},fs={class:"page-num"},gs={class:"page-total"},ms=["disabled"],ys={key:0,class:"sr-toast"},bs={__name:"index",setup(ks){const d=v("all"),o=v(1),k=v(10),C=v(0),g=v([]),_=v(!1),m=U(()=>Math.max(1,Math.ceil(C.value/k.value))),i=Y({show:!1,text:"",t:null}),N=(l,e=1600)=>{i.text=l,i.show=!0,clearTimeout(i.t),i.t=setTimeout(()=>i.show=!1,e)},S=async({page:l,pageSize:e,type:t})=>{await new Promise(n=>setTimeout(n,450));const x=Array.from({length:57}).map((n,c)=>{const h=c%3!==0,j=h?10+c%7*5:-(5+c%6*5),T=["签到奖励","完成喂养","连续参与","活动加成","分享助力"],B=["兑换徽章","兑换物资","提现手续费","兑换周边","补贴扣减"],q=h?T[c%T.length]:B[c%B.length],E=h?`获得积分奖励（第 ${c+1} 条）`:`消耗积分用于兑换（第 ${c+1} 条）`,p=new Date(Date.now()-c*3600*8*1e3),b=I=>String(I).padStart(2,"0"),H=`${p.getFullYear()}-${b(p.getMonth()+1)}-${b(p.getDate())} ${b(p.getHours())}:${b(p.getMinutes())}`;return{id:c+1,source:q,desc:E,amount:j,time:H,balance:1280+z(c)}});function z(n){const h=n%3!==0?10+n%7*5:-(5+n%6*5);return-Math.floor(n/2)+h}let y=x;t==="in"&&(y=x.filter(n=>n.amount>0)),t==="out"&&(y=x.filter(n=>n.amount<0));const L=y.length,P=(l-1)*e,V=P+e;return{list:y.slice(P,V),total:L}},M=async()=>{_.value=!0;try{const l=await S({page:o.value,pageSize:k.value,type:d.value});g.value=l.list||[],C.value=l.total??0}catch{N("加载失败，请稍后重试")}finally{_.value=!1}},w=l=>{d.value!==l&&(d.value=l,o.value=1)},A=()=>{o.value<=1||(o.value-=1)},F=()=>{o.value>=m.value||(o.value+=1)};return G([o,k,d],M),J(M),K(()=>{clearTimeout(i.t)}),(l,e)=>(r(),u("div",Q,[s("div",W,[s("div",X,[e[3]||(e[3]=s("div",{class:"sr-title"},"积分记录",-1)),s("div",Z,[s("div",ss,"本页 "+a(g.value.length)+" 条",1),s("div",ts,"第 "+a(o.value)+" / "+a(m.value)+" 页",1)])]),s("div",es,[s("button",{class:f(["filter",{active:d.value==="all"}]),onClick:e[0]||(e[0]=t=>w("all"))}," 全部 ",2),s("button",{class:f(["filter",{active:d.value==="in"}]),onClick:e[1]||(e[1]=t=>w("in"))}," 仅收入 ",2),s("button",{class:f(["filter",{active:d.value==="out"}]),onClick:e[2]||(e[2]=t=>w("out"))}," 仅支出 ",2)]),s("div",as,[_.value?(r(),u("div",os,[(r(),u($,null,D(6,t=>s("div",{class:"sk-row",key:t})),64))])):(r(),u($,{key:1},[g.value.length===0?(r(),u("div",ls,"暂无记录")):(r(!0),u($,{key:1},D(g.value,t=>(r(),u("div",{class:"sr-item",key:t.id},[s("div",ns,[s("div",cs,[s("span",is,a(t.source),1),s("span",{class:f(["tag",t.amount>0?"in":"out"])},a(t.amount>0?"收入":"支出"),3)]),s("div",us,a(t.desc),1),s("div",rs,a(t.time),1)]),s("div",ds,[s("div",{class:f(["amount",t.amount>0?"plus":"minus"])},a(t.amount>0?"+":"")+a(t.amount),3),s("div",vs,"余额 "+a(t.balance),1)])]))),128))],64))]),s("div",_s,[s("button",{class:"page-btn",disabled:o.value<=1||_.value,onClick:A}," 上一页 ",8,hs),s("div",ps,[s("span",fs,a(o.value),1),e[4]||(e[4]=s("span",{class:"slash"},"/",-1)),s("span",gs,a(m.value),1)]),s("button",{class:"page-btn",disabled:o.value>=m.value||_.value,onClick:F}," 下一页 ",8,ms)])]),i.show?(r(),u("div",ys,a(i.text),1)):O("",!0)]))}},$s=R(bs,[["__scopeId","data-v-2366bfd4"]]);export{$s as default};
